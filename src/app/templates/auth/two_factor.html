{% extends "auth/base.html" %}

{% block title %}Two-Factor Authentication{% endblock %}

{% block form_content %}
<div class="container">
    <div class="section-header">
        <h1 class="section-title">Two-Factor Authentication</h1>
    </div>
    <div class="security-card">
        <h2 class="card-title">
            <i class="fas fa-shield-alt"></i> Verify Your Identity
        </h2>
        <p class="card-description">
            {% if current_user.otp_type == 'app' %}
                Enter the 6-digit code generated by your authenticator app to complete the login process.
            {% elif current_user.otp_type == 'email' %}
                Enter the code sent to your email to complete the login process.
            {% elif current_user.otp_type == 'phone' %}
                Enter the code sent to your phone via SMS to complete the login process.
            {% endif %}
        </p>
        <form method="POST">
            {{ form.hidden_tag() }}
            <div class="form-group">
                <label for="token">2FA Token</label>
                {{ form.token(class="form-control") }}
            </div>
            <button type="submit" class="btn btn-primary">Verify</button>
        </form>
    </div>
</div>
{% endblock %}
